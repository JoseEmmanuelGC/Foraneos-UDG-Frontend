const host="https://api.foraneos-udg.ml/api/";class API{static async get(e,t){let o,a;try{const s=await fetch(`${host}${e}`,{method:"GET",headers:{token:t}});console.log(s),a=await s.status;const n=await s.json();console.log(n),o=await n}catch(e){return e}return{status:a,data:o}}async get(e,t){let o,a;try{const s=await fetch(`${this.host}/${e}/${t}`,{method:"GET"});a=await s.status;const n=await s.json();o=await n}catch(e){return e}return{status:a,data:o}}async post(e,t,o){const a=await fetch(`${host}/${e}`,{method:"POST",body:new URLSearchParams(t),headers:{token:o}}),s=await a.status,n=await a.json();return{status:s,response:await n}}async update(e,t,o,a){const s=await fetch(`${this.host}/${e}/${o}`,{method:"PUT",body:new URLSearchParams(t),headers:{token:a}}),n=await s.status,i=await s.json();return{status:n,response:await i}}async delete(e,t,o){await fetch(`${this.host}/${e}/${t}`,{method:"DELETE",headers:{token:o}})}async login(e,t){const o=await fetch(`${this.host}/auth/login`,{method:"POST",body:new URLSearchParams({email:e,password:t})}),a=await o.status,s=await o.json();return{status:a,response:await s}}async logout(e){const t=await fetch(`${this.host}/auth/logout`,{method:"GET",headers:{token:e}}),o=await t.status,a=await t.json();return{status:o,response:await a}}async activeSession(e){const t=await fetch(`${this.host}/auth/session`,{method:"GET",headers:{token:e}}),o=await t.status,a=await t.json();return{status:o,response:await a}}}export default API;const fetch=require("node-fetch"),{URLSearchParams:URLSearchParams}=require("url");class API{constructor(){this.host="https://api.foraneos-udg.ml/api/"}async getAll(e,t){let o,a;try{const s=await fetch(`${this.host}/${e}`,{method:"GET",headers:{token:t}});a=await s.status;const n=await s.json();o=await n}catch(e){return e}return{status:a,response:o}}async get(e,t){let o,a;try{const s=await fetch(`${this.host}/${e}/${t}`,{method:"GET"});a=await s.status;const n=await s.json();o=await n}catch(e){return e}return{status:a,response:o}}async insert(e,t,o){const a=await fetch(`${this.host}/${e}`,{method:"POST",body:new URLSearchParams(t),headers:{token:o}}),s=await a.status,n=await a.json();return{status:s,response:await n}}async update(e,t,o,a){const s=await fetch(`${this.host}/${e}/${o}`,{method:"PUT",body:new URLSearchParams(t),headers:{token:a}}),n=await s.status,i=await s.json();return{status:n,response:await i}}async delete(e,t,o){await fetch(`${this.host}/${e}/${t}`,{method:"DELETE",headers:{token:o}})}async login(e,t){const o=await fetch(`${this.host}/auth/login`,{method:"POST",body:new URLSearchParams({email:e,password:t})}),a=await o.status,s=await o.json();return{status:a,response:await s}}async logout(e){const t=await fetch(`${this.host}/auth/logout`,{method:"GET",headers:{token:e}}),o=await t.status,a=await t.json();return{status:o,response:await a}}async activeSession(e){const t=await fetch(`${this.host}/auth/session`,{method:"GET",headers:{token:e}}),o=await t.status,a=await t.json();return{status:o,response:await a}}}module.exports=new API;import API from"./api.js";class Cookie{static setCookie(e,t){document.cookie=`${e}=${t}`}static getCookie(e){return`; ${document.cookie}`.split(`; ${e}=`)[1].split(";")}static saveCookies({hash:e,user:t,type:o}){this.setCookie("session",e),this.setCookie("user",t),this.setCookie("type",o)}static haveSession(){this.getCookie("session");null!=myToken&&window.location.replace("./home.html")}static async login(e){const t=this.getCookie("session"),o=await API.post("auth/login",e,t);o.status>=200&&o.status<300&&(this.saveCookies(o.data),window.location.replace("./profile.html"))}static logout(){getCookie("session")}static logOut(){let e="Thu, 01 Jan 1970 00:00:00 UTC",t=Cookie.getCookie("userToken");console.log(t),document.cookie=`userToken=;path=/;expires=${e};`,document.cookie=`userName=;path=/;expires=${e};`,document.cookie=`userRole=;path=/;expires=${e};`,fetch("https://easy-motion.herokuapp.com/auth/logout",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>{200==e.status&&(console.log("200"),window.location.href="./home.html")}),console.log("s")}static exito(e,t,o){let a=new Date;a.setTime(a.getTime()+3e5),document.cookie=`userToken=${e};path=/;expires=${a.toGMTString()};`,document.cookie=`userName=${t};path=/;expires=${a.toGMTString()};`,document.cookie=`userRole=${o};path=/;expires=${a.toGMTString()};`,console.log("exito"),window.location.replace("./home.html")}}export default Cookie;class Cookie{static getCookie(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}static logOut(){let e="Thu, 01 Jan 1970 00:00:00 UTC",t=Cookie.getCookie("userToken");console.log(t),document.cookie=`userToken=;path=/;expires=${e};`,document.cookie=`userName=;path=/;expires=${e};`,document.cookie=`userRole=;path=/;expires=${e};`,fetch("https://api.foraneos-udg.ml/auth/logout",{method:"GET",headers:{"Content-Type":"application/json",hash:`${t}`}}).then(e=>{200==e.status&&(console.log("200"),window.location.href="./index.html")}),console.log("s")}static haveSession(){null!=Cookie.getCookie("userToken")&&window.location.replace("./index.html")}static noSession(){null==Cookie.getCookie("userToken")&&window.location.replace("./index.html")}static exito(e,t,o){let a=new Date;a.setTime(a.getTime()+3e5),document.cookie=`userToken=${e};path=/;expires=${a.toGMTString()};`,document.cookie=`userName=${t};path=/;expires=${a.toGMTString()};`,document.cookie=`userRole=${o};path=/;expires=${a.toGMTString()};`,console.log("exito"),window.location.replace("./home.html")}}export default Cookie;function getParametro(e){const t=window.location.search.substring(1).split("&");for(let o=0;o<t.length;o+=1){const a=t[o].split("=");if(a[0]==e)return a[1]}return null}import Cookie from"./cookie.js";import Validator from"./Svalidator.js";function iniciar(){Cookie.noSession(),function(){const e=document.querySelector("#datos_perfil"),t=document.querySelector("#username"),o=document.querySelector("#userdate");let a=Cookie.getCookie("userToken");fetch("https://api.foraneos-udg.ml/api/users/1",{method:"GET",headers:{"Content-Type":"application/json",hash:`Bearer ${a}`}}).then(e=>e.json()).then(a=>{200==a.status&&(console.log(a),t.innerHTML=`<h4>Username: ${a.username}</h4>`,e.innerHTML=`<p>Nombre Completo: ${a.name} ${a.firstSurname} ${a.secondSurname}</p>\n      <p>Correo Electronico: ${a.mainEmail}</p>`,o.innerHTML=`\n      <input id="username" type="text" name="username" value=${a.username} class="input3" readonly>\n      <input id="name" type="text" name="name" value=${a.name}  class="input3" readonly>\n      <input id="lastname" type="text" name="lastname" value="${a.firstSurname} ${a.secondSurname}" class="input3" readonly>\n      <input id="infemail" type="email" name="email" value=${a.mainEmail} class="input3" readonly>\n      <input id="regpassword" type="password" name="password" value=${a.password} class="input3" readonly>\n      <input id="birthdate" type="date" name="birthdate" value=${a.birthdate} class="input3" readonly>\n      `)})}()}window.onload=iniciar;const contenido=document.querySelector("#datos_perfil"),username=document.querySelector("#username"),datos=document.querySelector("#userdate"),miInit={method:"GET",headers:{"Content-Type":"application/json",hash:"$2b$17$f9/IC.1PDPvGNv/EI2YvxOKuBORKF5GlauVpO5fDkkh5fsRxNHO/e"},cache:"default"};fetch("https://api.foraneos-udg.ml/api/users/1",miInit).then(e=>e.json()).then(e=>{console.log(e),username.innerHTML=`<h4>Username: ${e.username}</h4>`,contenido.innerHTML=`<p>Nombre Completo: ${e.name} ${e.firstSurname} ${e.secondSurname}</p>\n    <p>Correo Electronico: ${e.mainEmail}</p>`,datos.innerHTML=`\n    <input id="username" type="text" name="username" value=${e.username} class="input3" readonly>\n    <input id="name" type="text" name="name" value=${e.name}  class="input3" readonly>\n    <input id="lastname" type="text" name="lastname" value="${e.firstSurname} ${e.secondSurname}" class="input3" readonly>\n    <input id="infemail" type="email" name="email" value=${e.mainEmail} class="input3" readonly>\n    <input id="regpassword" type="password" name="password" value=${e.password} class="input3" readonly>\n    <input id="birthdate" type="date" name="birthdate" value=${e.birthdate} class="input3" readonly>\n    `}).catch(e=>{console.error(e)});class Validator{static functionsarray(){return{isMaxLength30:{tipo:["name"],metodo:e=>e.length>30,msg:"Es mayor a 30 caracteres"},isMinLength6:{tipo:["newPassword"],metodo:e=>e.length<6,msg:"Es menor a 6 caracteres"},isMail:{tipo:["email"],metodo:e=>!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),msg:"No es un email valido"},isWord:{tipo:["name"],metodo:e=>!/[a-zA-ZñÑ]{3,}/.test(e),msg:"No es una palabra valida"},isVacio:{tipo:["email","password","weight","height","name","mobile"],metodo:e=>0===e.length,msg:"Ingrese los datos"},isWeight:{tipo:["weight"],metodo:e=>e.length>3||Number(e)<0||Number(e)>250,msg:"Peso entre 0 y 250kg"},isHeight:{tipo:["height"],metodo:e=>e.length>3||Number(e)<0||Number(e)>300,msg:"Altura entre 0 y 300 CM"},isSpace:{tipo:["password","name","mobile"],metodo:e=>" "===e[0],msg:"No puede iniciar con espacio"},isMobile:{tipo:["mobile"],metodo:e=>10!==e.length,msg:"Ingrese un numero de 10 digitos"}}}static validateSomething(e,t){const o=[],a=Validator.functionsarray();for(const s in a){const n=a[s];-1!==n.tipo.indexOf(e)&&n.metodo(t)&&o.push(n.msg)}return o}static deleteErrors(){const e=document.getElementsByClassName("error-msg");for(;e.length>0;)e[0].parentNode.removeChild(e[0]);document.querySelectorAll(".error").forEach(e=>{e.classList.remove("error")})}static validate(e){const t=e.target.parentNode;let o;Validator.deleteErrors();for(const s of t)if("submit"!=s.type&&(o=Validator.validateSomething(s.name,s.value)).length>0){e.preventDefault(),s.classList.add("error");var a=document.createElement("div");a.classList.add("error-msg"),o.forEach(e=>{const t=document.createElement("h1"),o=document.createTextNode(e);t.appendChild(o),a.appendChild(t)}),s.parentNode.insertBefore(a,s.nextSibling)}}static listen2(){const e=document.getElementsByClassName("form");for(const t of e)for(const e of t.children)"submit"==e.type&&e.addEventListener("click",Validator.validate,!1)}static listen(e){for(const t of e.children)"submit"==t.type&&t.addEventListener("submit",Validator.validate,!1)}static haiteva(e){console.log("x: ",e)}}export default Validator;const realFileBtn=document.getElementById("real-file"),customBtn=document.getElementById("btnupload"),customTxt=document.getElementById("custom-text");function validatorRegister(){var e=document.getElementById("name").value,t=document.getElementById("lastname").value,o=document.getElementById("regemail").value,a=document.getElementById("regpassword").value,s=document.getElementById("confirpass").value,n=!1;if(console.log(e),console.log(a),n)n=!0;else{if(null==e||0==e.length||0==/^[a-zA-Z_áéíóúñÁÉÍÓÚÑ\s]*$/.test(e))return document.getElementById("name").style.borderColor="red",!1;if(document.getElementById("name").style.borderColor="black",null==t||0==t.length||0==/^[a-zA-Z_áéíóúñÁÉÍÓÚÑ\s]*$/.test(t))return document.getElementById("lastname").style.borderColor="red",!1;if(document.getElementById("lastname").style.borderColor="black",null==o||0==o.length||0==/[_a-z0-9-]+(.[_a-z0-9-]+)*@[a-z0-9-]+(.[a-z0-9-]+)*(.[a-z]{2,4})$/.test(o))return document.getElementById("regemail").style.borderColor="red",!1;if(document.getElementById("regemail").style.borderColor="black",null==a||0==a.length||0==/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{6,20}$/.test(a))return document.getElementById("regpassword").style.borderColor="red",!1;if(document.getElementById("regpassword").style.borderColor="black",null==s||0==s.length||0==/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{6,20}$/.test(s)||s!==a)return document.getElementById("confirpass").style.borderColor="red",!1;document.getElementById("confirpass").style.borderColor="black"}if(n)return document.getElementById("name").style.borderColor="black",document.getElementById("lastname").style.borderColor="black",document.getElementById("regemail").style.borderColor="black",document.getElementById("regpassword").style.borderColor="black",document.getElementById("confirpass").style.borderColor="black",!0}customBtn.addEventListener("click",()=>{realFileBtn.click()}),realFileBtn.addEventListener("change",()=>{realFileBtn.value?customTxt.innerHTML=realFileBtn.value.match(/[\/\\]([\w\d\s\.\-\(\)]+)$/)[1]:customTxt.innerHTML="No file chosen, yet."});